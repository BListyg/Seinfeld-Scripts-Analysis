# fix episode_info column types
episode_info$AirDate <- mdy(episode_info$AirDate)
episode_info$Season <- as.factor(episode_info$Season)
episode_info$EpisodeNo <- as.factor(episode_info$EpisodeNo)
scripts$EpisodeNo <- as.factor(scripts$EpisodeNo)
scripts$Season <- as.factor(scripts$Season)
scripts$Character <- as.factor(scripts$Character)
# one-token-per-row format --> each row represents a word in the dialogue
tidy_scripts <- scripts %>%
unnest_tokens(word, Dialogue)
tidy_scripts <- tidy_scripts %>%
anti_join(stop_words) %>%
select(-X1)
kable(head(tidy_scripts), format = "html",
caption = "Tokenization of each word in the scripts data frame")
top9_mainCharacters <-  scripts %>%
group_by(Character) %>%
summarise(Count = n()) %>%
arrange(desc(Count)) %>%
ungroup() %>%
mutate(Character = reorder(Character, Count)) %>%
head(9)
top9_mainCharacters %>%
ggplot() +
geom_bar(aes(x = Character, y = Count), stat = "identity", fill = "yellow") +
geom_text(aes(x = Character, y = 1, label = paste0("(", Count, ")")), hjust = 0, vjust = .5,
size = 4, fontface = 'bold') +
scale_y_continuous(labels = comma) +
labs(x = "Character", y = "Total Lines Spoken",
title = "Number of lines spoken by top characters") +
coord_flip() + theme_bw()
scripts <- scripts %>%
mutate(len = str_count(Dialogue, "\\S+"))
longWindedCharacters <- scripts %>%
filter(Character %in% top9_mainCharacters$Character)
summary(longWindedCharacters)
# use median rather than mean because the len is skewed
longWindedCharacters %>%
group_by(Character) %>%
summarise(Median = median(len, na.rm = T)) %>%
mutate(Character = reorder(Character, Median)) %>%
ggplot() +
geom_bar(aes(x = Character, y = Median), stat = "identity", fill = "red") +
geom_text(aes(x = Character, y = Median, label = paste0("(", Median, ")")), vjust = .3, hjust = 1.2,
fontface = "bold") +
ggtitle("Median number of words spoken by character") +
coord_flip()
scripts <- scripts %>%
mutate(len = str_count(Dialogue, "\\S+"))
longWindedCharacters <- scripts %>%
filter(Character %in% top9_mainCharacters$Character)
summary(longWindedCharacters)
# use median rather than mean because the len is skewed
longWindedCharacters %>%
group_by(Character) %>%
summarise(Median = median(len, na.rm = T)) %>%
mutate(Character = reorder(Character, Median)) %>%
ggplot() +
geom_bar(aes(x = Character, y = Median), stat = "identity", fill = "red") +
geom_text(aes(x = Character, y = Median, label = paste0("(", Median, ")")), vjust = .3, hjust = 0,
fontface = "bold") +
ggtitle("Median number of words spoken by character") +
coord_flip()
scripts <- scripts %>%
mutate(len = str_count(Dialogue, "\\S+"))
longWindedCharacters <- scripts %>%
filter(Character %in% top9_mainCharacters$Character)
summary(longWindedCharacters)
# use median rather than mean because the len is skewed
longWindedCharacters %>%
group_by(Character) %>%
summarise(Median = median(len, na.rm = T)) %>%
mutate(Character = reorder(Character, Median)) %>%
ggplot() +
geom_bar(aes(x = Character, y = Median), stat = "identity", fill = "red") +
geom_text(aes(x = Character, y = Median, label = paste0("(", Median, ")")), vjust = .5, hjust = 0,
fontface = "bold") +
ggtitle("Median number of words spoken by character") +
coord_flip()
scripts <- scripts %>%
mutate(len = str_count(Dialogue, "\\S+"))
longWindedCharacters <- scripts %>%
filter(Character %in% top9_mainCharacters$Character)
summary(longWindedCharacters)
# use median rather than mean because the len is skewed
longWindedCharacters %>%
group_by(Character) %>%
summarise(Median = median(len, na.rm = T)) %>%
mutate(Character = reorder(Character, Median)) %>%
ggplot() +
geom_bar(aes(x = Character, y = Median), stat = "identity", fill = "red") +
geom_text(aes(x = Character, y = Median, label = paste0("(", Median, ")")), vjust = .5, hjust = -1,
fontface = "bold") +
ggtitle("Median number of words spoken by character") +
coord_flip()
scripts <- scripts %>%
mutate(len = str_count(Dialogue, "\\S+"))
longWindedCharacters <- scripts %>%
filter(Character %in% top9_mainCharacters$Character)
summary(longWindedCharacters)
# use median rather than mean because the len is skewed
longWindedCharacters %>%
group_by(Character) %>%
summarise(Median = median(len, na.rm = T)) %>%
mutate(Character = reorder(Character, Median)) %>%
ggplot() +
geom_bar(aes(x = Character, y = Median), stat = "identity", fill = "red") +
geom_text(aes(x = Character, y = Median, label = paste0("(", Median, ")")), vjust = .5, hjust = 1,
fontface = "bold") +
ggtitle("Median number of words spoken by character") +
coord_flip()
scripts <- scripts %>%
mutate(len = str_count(Dialogue, "\\S+"))
longWindedCharacters <- scripts %>%
filter(Character %in% top9_mainCharacters$Character)
summary(longWindedCharacters)
# use median rather than mean because the len is skewed
longWindedCharacters %>%
group_by(Character) %>%
summarise(Median = median(len, na.rm = T)) %>%
mutate(Character = reorder(Character, Median)) %>%
ggplot() +
geom_bar(aes(x = Character, y = Median), stat = "identity", fill = "red") +
geom_text(aes(x = Character, y = Median, label = paste0("(", Median, ")")), vjust = .5, hjust = 1.5,
fontface = "bold") +
ggtitle("Median number of words spoken by character") +
coord_flip()
tidy_scripts %>%
count(word, sort = TRUE)
tidy_scripts %>%
count(word, sort = TRUE) %>%
slice(1:10)
# ggplot(aes)
tidy_scripts %>%
count(word, sort = TRUE)
# slice(1:10)
# ggplot(aes)
tidy_scripts %>%
count(word, sort = TRUE) %>%
slice(1:10)
# ggplot(aes)
tidy_scripts %>%
count(word, sort = TRUE) %>%
slice(1:10) %>%
ggplot(aes(x = word, y = n)) +
geom_bar()
tidy_scripts %>%
count(word, sort = TRUE) %>%
slice(1:10) %>%
ggplot(aes(x = word, y = n)) +
geom_bar(stat = "identity")
tidy_scripts %>%
count(word, sort = TRUE) %>%
slice(1:10) %>%
ggplot(aes(x = word, y = n)) +
geom_bar(stat = "identity", fill = "green")
tidy_scripts %>%
count(word, sort = TRUE) %>%
slice(1:10) %>%
ggplot(aes(x = word, y = n)) +
geom_bar(stat = "identity", fill = "purple")
tidy_scripts %>%
count(word, sort = TRUE) %>%
slice(1:10) %>%
ggplot(aes(x = word, y = n)) +
geom_bar(stat = "identity", fill = "purple") %>%
geom_label(stat = "identity")
tidy_scripts %>%
count(word, sort = TRUE) %>%
slice(1:10) %>%
ggplot(aes(x = word, y = n)) +
geom_bar(stat = "identity", fill = "purple") %>%
geom_label(aes(x = word, y = n, label = paste0("(", n, ")", sep = "")))
tidy_scripts %>%
count(word, sort = TRUE) %>%
slice(1:10) %>%
ggplot(aes(x = word, y = n)) +
geom_bar(stat = "identity", fill = "purple") +
geom_label(aes(x = word, y = n, label = paste0("(", n, ")", sep = "")))
tidy_scripts %>%
count(word, sort = TRUE) %>%
slice(1:10) %>%
ggplot(aes(x = word, y = n)) +
geom_bar(stat = "identity", fill = "purple") +
geom_text(aes(x = word, y = n, label = paste0("(", n, ")", sep = "")))
tidy_scripts %>%
count(word, sort = TRUE) %>%
slice(1:10) %>%
ggplot(aes(x = word, y = n)) +
geom_bar(stat = "identity", fill = "purple") +
geom_text(aes(x = word, y = n, label = paste0("(", n, ")", sep = ""), vjust = 1))
tidy_scripts %>%
count(word, sort = TRUE) %>%
slice(1:10) %>%
ggplot(aes(x = word, y = n)) +
geom_bar(stat = "identity", fill = "purple") +
geom_text(aes(x = word, y = n, label = paste0("(", n, ")", sep = ""), vjust = 1.5))
tidy_scripts %>%
count(word, sort = TRUE) %>%
slice(1:10) %>%
ggplot(aes(x = word, y = n)) +
geom_bar(stat = "identity", fill = "purple") +
geom_text(aes(x = word, y = n, label = paste0("(", n, ")", sep = ""), vjust = 1.5, fontface = "bold"))
tidy_scripts %>%
count(word, sort = TRUE) %>%
slice(1:10) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(x = word, y = n)) +
geom_bar(stat = "identity", fill = "purple") +
geom_text(aes(x = word, y = n, label = paste0("(", n, ")", sep = ""), vjust = 1.5, fontface = "bold"))
tidy_scripts %>%
count(word, sort = TRUE) %>%
slice(1:10) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(x = word, y = n)) +
geom_bar(stat = "identity", fill = "purple") +
geom_text(aes(x = word, y = n, label = paste0("(", n, ")", sep = ""),
vjust = 1.5, fontface = "bold")) +
scale_y_continuous(name = "Frequency", labels = comma)
tidy_scripts %>%
count(word, sort = TRUE) %>%
slice(1:10) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(x = word, y = n)) +
geom_bar(stat = "identity", fill = "purple") +
geom_text(aes(x = word, y = n, label = paste0("(", n, ")", sep = ""),
vjust = 1.5, fontface = "bold")) +
scale_y_continuous(name = "Frequency", labels = comma) +
xlab("Word")
tidy_scripts %>%
count(word, sort = TRUE) %>%
slice(1:10) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(x = word, y = n)) +
geom_bar(stat = "identity", fill = "purple") +
geom_text(aes(x = word, y = n, label = paste0("(", n, ")", sep = ""),
vjust = 1.5, fontface = "bold")) +
scale_y_continuous(name = "Frequency", labels = comma) +
xlab("Word") +
coord_flip()
tidy_scripts %>%
count(word, sort = TRUE) %>%
slice(1:10) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(x = word, y = n)) +
geom_bar(stat = "identity", fill = "purple") +
geom_text(aes(x = word, y = n, label = paste0("(", n, ")", sep = ""),
vjust = 0, hjust = 1, fontface = "bold")) +
scale_y_continuous(name = "Frequency", labels = comma) +
xlab("Word") +
coord_flip()
tidy_scripts %>%
count(word, sort = TRUE) %>%
slice(1:10) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(x = word, y = n)) +
geom_bar(stat = "identity", fill = "purple") +
geom_text(aes(x = word, y = n, label = paste0("(", n, ")", sep = ""),
vjust = 0, hjust = 1.5, fontface = "bold")) +
scale_y_continuous(name = "Frequency", labels = comma) +
xlab("Word") +
coord_flip()
tidy_scripts %>%
count(word, sort = TRUE) %>%
slice(1:10) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(x = word, y = n)) +
geom_bar(stat = "identity", fill = "purple") +
geom_text(aes(x = word, y = n, label = paste0("(", n, ")", sep = ""),
vjust = 0, hjust = 1.2, fontface = "bold")) +
scale_y_continuous(name = "Frequency", labels = comma) +
xlab("Word") +
coord_flip()
tidy_scripts %>%
count(word, sort = TRUE) %>%
slice(1:10) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(x = word, y = n)) +
geom_bar(stat = "identity", fill = "purple") +
geom_text(aes(x = word, y = n, label = paste0("(", n, ")", sep = ""),
vjust = 0.2, hjust = 1.2, fontface = "bold")) +
scale_y_continuous(name = "Frequency", labels = comma) +
xlab("Word") +
coord_flip()
tidy_scripts %>%
count(word, sort = TRUE) %>%
slice(1:10) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(x = word, y = n)) +
geom_bar(stat = "identity", fill = "purple") +
geom_text(aes(x = word, y = n, label = paste0("(", n, ")", sep = ""),
vjust = 0.4, hjust = 1.2, fontface = "bold")) +
scale_y_continuous(name = "Frequency", labels = comma) +
xlab("Word") +
coord_flip()
tidy_scripts %>%
count(word, sort = TRUE) %>%
slice(1:10) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(x = word, y = n)) +
geom_bar(stat = "identity", fill = "purple") +
geom_text(aes(x = word, y = n, label = paste0("(", n, ")", sep = ""),
vjust = 0.4, hjust = 1.2, fontface = "bold")) +
scale_y_continuous(name = "Frequency", labels = comma) +
xlab("Word") +
ggtitle("Top 10 most frequently used words and their frequencies")
coord_flip()
typeof(tidy_scripts$Season)
tidy_scripts %>%
count(word, sort = TRUE) %>%
slice(1:10) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(x = word, y = n)) +
geom_bar(stat = "identity", fill = "purple") +
geom_text(aes(x = word, y = n, label = paste0("(", n, ")", sep = ""),
vjust = 0.4, hjust = 1.2, fontface = "bold")) +
scale_y_continuous(name = "Frequency", labels = comma) +
xlab("Word") +
ggtitle("Top 10 most frequently used words and their frequencies") +
coord_flip()
tidy_season_1 <- tidy_season_script(1)
tidy_season_script <- function(season_num) {
myDF <-  tidy_scripts %>%
group_by(Season) %>%
filter(Season == season_num)
return(myDF)
}
tidy_season_1 <- tidy_season_script(1)
tidy_season_2 <- tidy_season_script(2)
tidy_season_3 <- tidy_season_script(3)
tidy_seaon_4 <- tidy_season_script(4)
tidy_seaon_5 <- tidy_season_script(5)
tidy_seaon_6 <- tidy_seaon_script(6)
tidy_seaon_6 <- tidy_season_script(6)
tidy_season_1 <- tidy_season_script(1)
tidy_season_2 <- tidy_season_script(2)
tidy_season_3 <- tidy_season_script(3)
tidy_season_4 <- tidy_season_script(4)
tidy_season_5 <- tidy_season_script(5)
tidy_season_6 <- tidy_season_script(6)
tidy_season_7 <- tidy_season_script(7)
tidy_season_8 <- tidy_season_script(8)
tidy_season_9 <- tidy_season_script(9)
tidy_scripts %>%
group_by(Season) %>%
summarise(numWords = n())
tidy_scripts %>%
group_by(Season) %>%
summarise(numWords = n()) %>%
mutate(Season = reorder(Season, numWords))
tidy_scripts %>%
group_by(Season) %>%
summarise(numWords = n()) %>%
mutate(Season = reorder(Season, numWords)) %>%
ggplot() +
geom_col()
tidy_scripts %>%
group_by(Season) %>%
summarise(numWords = n()) %>%
mutate(Season = reorder(Season, numWords)) %>%
ggplot() +
geom_col(aes(x = Season, y = numWords))
tidy_scripts %>%
group_by(Season) %>%
summarise(numWords = n()) %>%
mutate(Season = reorder(Season, numWords)) %>%
ggplot() +
geom_col(aes(x = Season, y = numWords, fill = Season))
tidy_scripts %>%
group_by(Season) %>%
summarise(numWords = n()) %>%
mutate(Season = reorder(Season, numWords)) %>%
ggplot() +
geom_col(aes(x = Season, y = numWords), fill = Season)
fill = Season
tidy_scripts %>%
group_by(Season) %>%
summarise(numWords = n()) %>%
mutate(Season = reorder(Season, numWords)) %>%
ggplot() +
geom_col(aes(x = Season, y = numWords, fill = Season))
tidy_scripts %>%
group_by(Season) %>%
summarise(numWords = n()) %>%
mutate(Season = reorder(Season, numWords)) %>%
ggplot() +
geom_col(aes(x = Season, y = numWords, fill = Season)) +
geom_text(aes(x = Season, y = numWords, label = paste("(", numWords, ")", sep = "")),
fontface = "bold")
tidy_scripts %>%
group_by(Season) %>%
summarise(numWords = n() / 1000) %>%
mutate(Season = reorder(Season, numWords)) %>%
ggplot() +
geom_col(aes(x = Season, y = numWords, fill = Season)) +
geom_text(aes(x = Season, y = numWords, label = paste("(", numWords, ")", sep = "")),
fontface = "bold")
?round
tidy_scripts %>%
group_by(Season) %>%
summarise(numWords = n() / 1000) %>%
mutate(Season = reorder(Season, numWords)) %>%
ggplot() +
geom_col(aes(x = Season, y = numWords, fill = Season)) +
geom_text(aes(x = Season, y = numWords,
label = paste("(", signif(numWords, digits = 2), ")", sep = "")), fontface = "bold")
tidy_scripts %>%
group_by(Season) %>%
summarise(numWords = n() / 1000) %>%
mutate(Season = reorder(Season, numWords)) %>%
ggplot() +
geom_col(aes(x = Season, y = numWords, fill = Season)) +
geom_text(aes(x = Season, y = numWords,
label = paste("(", signif(numWords, digits = 3), ")", sep = "")), fontface = "bold")
tidy_scripts %>%
group_by(Season) %>%
summarise(numWords = n() / 1000) %>%
mutate(Season = reorder(Season, numWords)) %>%
ggplot() +
geom_col(aes(x = Season, y = numWords, fill = Season)) +
geom_text(aes(x = Season, y = numWords,
label = paste("(", signif(numWords, digits = 4), ")", sep = "")), fontface = "bold")
tidy_scripts %>%
group_by(Season) %>%
summarise(numWords = n() / 1000) %>%
mutate(Season = reorder(Season, numWords)) %>%
ggplot() +
geom_col(aes(x = Season, y = numWords, fill = Season)) +
geom_text(aes(x = Season, y = numWords,
label = paste("(", signif(numWords, digits = 4), ")", sep = "")),
fontface = "bold") +
labs(x = "Season", y = "Total Word Count", title = "Total Word Count by Season") +
coord_flip()
tidy_scripts %>%
group_by(Season) %>%
summarise(numWords = n() / 1000) %>%
mutate(Season = reorder(Season, numWords)) %>%
ggplot() +
geom_col(aes(x = Season, y = numWords, fill = Season)) +
geom_text(aes(x = Season, y = numWords,
label = paste("(", signif(numWords, digits = 4), ")", sep = "")),
fontface = "bold") +
labs(x = "Season", y = "Total Word Count", title = "Total Word Count by Season")
tidy_scripts %>%
group_by(Season) %>%
summarise(numWords = n() / 1000) %>%
mutate(Season = reorder(Season, numWords)) %>%
ggplot() +
geom_col(aes(x = Season, y = numWords, fill = Season)) +
geom_text(aes(x = Season, y = numWords,
label = paste("(", signif(numWords, digits = 4), ")", sep = "")),
fontface = "bold", vjust = 1) +
labs(x = "Season", y = "Total Word Count", title = "Total Word Count by Season")
tidy_scripts %>%
group_by(Season) %>%
summarise(numWords = n() / 1000) %>%
mutate(Season = reorder(Season, numWords)) %>%
ggplot() +
geom_col(aes(x = Season, y = numWords, fill = Season)) +
geom_text(aes(x = Season, y = numWords,
label = paste("(", signif(numWords, digits = 4), ")", sep = "")),
fontface = "bold", vjust = 1.2) +
labs(x = "Season", y = "Total Word Count", title = "Total Word Count by Season")
tidy_scripts %>%
group_by(Season) %>%
summarise(numWords = n() / 1000) %>%
mutate(Season = reorder(Season, numWords)) %>%
ggplot() +
geom_col(aes(x = Season, y = numWords, fill = Season)) +
geom_text(aes(x = Season, y = numWords,
label = paste("(", signif(numWords, digits = 4), ")", sep = "")),
fontface = "bold", vjust = 1.2) +
labs(x = "Season", y = "Total Word Count (in thousands)", title = "Total Word Count by Season")
tidy_scripts %>%
group_by(Season) %>%
summarise(numWords = n() / 1000) %>%
mutate(Season = reorder(Season, numWords)) %>%
ggplot() +
geom_col(aes(x = Season, y = numWords, fill = Season)) +
geom_text(aes(x = Season, y = numWords,
label = paste("(", signif(numWords, digits = 4), ")", sep = "")),
fontface = "bold", vjust = 1.2) +
labs(x = "Season", y = "Total Word Count (in thousands)", title = "Total word count of each season")
tidy_scripts %>%
group_by(Season) %>%
summarise(numWords = n() / 1000) %>%
mutate(Season = reorder(Season, numWords)) %>%
ggplot() +
geom_col(aes(x = Season, y = numWords, fill = Season)) +
geom_text(aes(x = Season, y = numWords,
label = paste("(", signif(numWords, digits = 4), ")", sep = "")),
fontface = "bold", vjust = 1.2) +
labs(x = "Season", y = "Total Word Count (in thousands)", title = "Total Word Count of Each Season")
tidy_scripts %>%
group_by(Season) %>%
summarise(numWords = n() / 1000) %>%
mutate(Season = reorder(Season, numWords)) %>%
ggplot() +
geom_col(aes(x = Season, y = numWords, fill = Season)) +
geom_text(aes(x = Season, y = numWords,
label = paste("(", signif(numWords, digits = 4), ")", sep = "")),
fontface = "bold", vjust = 1.3) +
labs(x = "Season", y = "Total Word Count (in thousands)", title = "Total Word Count of Each Season")
tidy_season_1 <- tidy_season_script(1)
tidy_season_2 <- tidy_season_script(2)
tidy_season_3 <- tidy_season_script(3)
tidy_season_4 <- tidy_season_script(4)
tidy_season_5 <- tidy_season_script(5)
tidy_season_6 <- tidy_season_script(6)
tidy_season_7 <- tidy_season_script(7)
tidy_season_8 <- tidy_season_script(8)
tidy_season_9 <- tidy_season_script(9)
